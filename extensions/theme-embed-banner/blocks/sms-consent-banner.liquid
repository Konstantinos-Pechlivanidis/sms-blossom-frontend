{% comment %}
App Embed block: a simple banner to collect phone + consent and POST to App Proxy.
- Requires App Proxy subpath set in Partners: e.g. Subpath = sms-blossom â†’ storefront path /apps/sms-blossom
- This block injects assets/sms-consent-banner.js
{% endcomment %}

{% schema %}
{
  "name": "SMS Consent Banner",
  "target": "body",
  "settings": []
}
{% endschema %}
<div id="sms-consent-banner" data-shop="{{ shop.permanent_domain | escape }}" data-proxy="/apps/sms-blossom">
  <style>
    #sms-consent-banner { position: fixed; bottom: 0; left: 0; right: 0; background:#111; color:#fff; padding: 12px; z-index: 2147483647; }
    #sms-consent-banner form { display:flex; gap:8px; align-items:center; max-width: 720px; margin: 0 auto; }
    #sms-consent-banner input[type="tel"] { flex:1; padding: 8px; border-radius: 6px; border: 1px solid #444; background:#fff; color:#111; }
    #sms-consent-banner button { padding: 8px 12px; border-radius: 6px; border: 0; background:#24a148; color:#fff; cursor:pointer; }
    #sms-consent-banner small { color:#ddd; }
    #sms-consent-banner .sms-close { margin-left: 8px; background:#444; }
  </style>
  <form>
    <input id="sms-phone" type="tel" placeholder="+3069XXXXXXXX" aria-label="Mobile phone" />
    <button type="submit">Get SMS updates</button>
    <button type="button" class="sms-close">Close</button>
  </form>
  <small>By subscribing you agree to receive SMS from {{ shop.name }}. Reply STOP to opt out.</small>
  <div class="sms-msg" role="status" aria-live="polite" style="margin-top:6px;"></div>
</div>
<script src="{{ 'sms-consent-banner.js' | asset_url }}" defer></script>
